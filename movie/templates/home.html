{% extends "base.html" %}

{% block title %}Home • Movie Reviews{% endblock %}

{% block content %}
  <!-- HERO + SEARCH -->
  <section class="hero p-4 p-md-5 mb-5 shadow">
    <div class="row g-4 align-items-center">
      <div class="col-lg-6">
        <h1 class="fw-bold mb-2">Movie Reviews</h1>
        <p class="text-secondary mb-0">Discover, search and explore movie reviews in our catalog.</p>
      </div>
      <div class="col-lg-6">
        <form method="get" action="" class="mt-2 mt-lg-0">
          <div class="input-group input-group-lg">
            <span class="input-group-text bg-transparent text-light border-secondary">
              <i class="bi bi-search"></i>
            </span>
            <input
              type="text"
              class="form-control bg-transparent text-light border-secondary"
              name="searchMovie"
              placeholder="Search: Inception, Interstellar, Spider-Verse…"
              value="{{ searchTerm|default_if_none:'' }}"
              autocomplete="off"
            >
            <button class="btn btn-primary" type="submit">Search</button>
            {% if searchTerm %}
              <a href="." class="btn btn-outline-light">Clear</a>
            {% endif %}
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- RESUMEN BÚSQUEDA -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <p class="mb-0 small text-secondary">
      {% if searchTerm %}
        Searching: <strong>{{ searchTerm }}</strong>
      {% else %}
        Showing latest films
      {% endif %}
    </p>
    <span class="badge bg-secondary">{{ movies|length }} outcome{{ movies|length|pluralize }}</span>
  </div>

  <!-- GRID DE CARDS -->
  <div class="row row-cols-1 row-cols-lg-4 g-4">
    {% for movie in movies %}
    <div class="col">
      <div class="card h-100 shadow-sm movie-card text-dark">
        <img src="{{ movie.image.url }}" class="card-img-top poster" alt="{{ movie.title }}">
        <div class="card-body">
          <h5 class="card-title fw-bold text-truncate" title="{{ movie.title }}">{{ movie.title }}</h5>
          <p class="card-text small mb-1">{{ movie.description }}</p>
          <p class="card-text mb-1"><strong>Genre:</strong> {{ movie.genre }}</p>
          <p class="card-text"><strong>Year:</strong> {{ movie.year }}</p>
        </div>
        <div class="card-footer bg-transparent border-0 pt-0 pb-3 text-center">
          {% if movie.url %}
            <a href="{{ movie.url }}" target="_blank" class="btn btn-primary btn-sm">
              <i class="bi bi-play-circle"></i> Movie Link
            </a>
          {% else %}
            <button class="btn btn-secondary btn-sm" disabled>
              <i class="bi bi-link-45deg"></i> No link
            </button>
          {% endif %}
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12">
      <div class="alert alert-warning border-0">
        <i class="bi bi-emoji-frown"></i> We did not find results for
        <strong>{{ searchTerm }}</strong>. Try another term.
      </div>
    </div>
    {% endfor %}
  </div>
  
  <div class="card bg-light text-dark shadow-sm mt-5">
    <div class="card-body">
      <h2 class="h5 fw-bold mb-3">Join our mailing list</h2>
      <form action="{% url 'signup' %}" method="post">
        {% csrf_token %}
        <div class="mb-3">
          <label for="email" class="form-label">Enter your email:</label>
          <input type="email" class="form-control" id="email" name="email" required />
        </div>
        <button type="submit" class="btn btn-primary">
          <i class="bi bi-envelope"></i> Sign Up
        </button>
      </form>
    </div>
  </div>


{% endblock %}